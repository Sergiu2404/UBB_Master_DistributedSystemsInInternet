
# Introduction to EJB 3.2 (Enterprise JavaBeans)

## Overview
Enterprise JavaBeans (EJB) 3.2 is a server-side component architecture for developing modular, reusable, and distributed
Java applications. EJB 3.2 simplifies enterprise-level development by reducing boilerplate code and introducing annotations, 
dependency injection, and an improved persistence API.

---

## Key Features of EJB 3.2

1. **Java Annotations**: Replace XML configurations with straightforward annotations.
2. **Dependency Injection**: EJBs can inject dependencies directly, simplifying object management.
3. **Optional Callbacks**: Methods that handle lifecycle events within the EJB.
4. **Entity Manager API**: Manages the persistence of entity beans. 
5. **Simplified Persistence**: Allows mapping of Java objects to database tables.
6. **Improved Queries**: Leverages JPQL for creating efficient and dynamic queries.

---

## Examples

### 1. Basic Stateless Session Bean
- A stateless session bean is a type of enterprise bean which is commonly used to do independent operations. 
It does not have any associated client state, but it may preserve its instance state.

```java
import javax.ejb.Stateless;

@Stateless
public class SimpleService {
    public String sayHello(String name) {
        return "Hello, " + name;
    }
}
```

### 2. Dependency Injection
Inject dependencies directly using `@EJB`.
```java
import javax.ejb.EJB;
import javax.ejb.Stateless;

@Stateless
public class GreetingService {
    @EJB
    private SimpleService simpleService;

    public void greet(String name) {
        System.out.println(simpleService.sayHello(name));
    }
}
```

### 3. Stateful Session Bean
- Stateful session beans maintain state both within and between transactions. That is why each stateful session bean is 
associated with a specific client. Containers can save and retrieve the state of a bean automatically while managing 
instance pools of stateful session beans.
```java
import javax.ejb.Stateful;

@Stateful
public class CounterService {
    private int counter = 0;

    public int increment() {
        return ++counter;
    }
}
```

### 4. Optional Callbacks
Define lifecycle callbacks to handle EJB events like creation and destruction.
```java
import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;
import javax.ejb.Singleton;

@Singleton
public class LifecycleService {
    @PostConstruct
    public void init() {
        System.out.println("EJB Initialized");
    }

    @PreDestroy
    public void cleanup() {
        System.out.println("EJB Destroyed");
    }
}
```

### 5. Entity Manager API
Using `EntityManager` for database operations.
```java
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

@Stateless
public class ProductService {
    @PersistenceContext
    private EntityManager em;

    public void addProduct(Product product) {
        em.persist(product);
    }

    public Product findProductById(Long id) {
        return em.find(Product.class, id);
    }
}
```

### 6. Simplified Persistence
Using JPA annotations for a simple entity class.
```java
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Product {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String name;
    private double price;

    // Getters and setters
}
```

### 7. Improved Queries with JPQL
Using JPQL for a dynamic query.
```java
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.TypedQuery;
import java.util.List;

@Stateless
public class QueryService {
    @PersistenceContext
    private EntityManager em;

    public List<Product> findProductsByPrice(double price) {
        TypedQuery<Product> query = em.createQuery(
            "SELECT p FROM Product p WHERE p.price > :price", Product.class
        );
        query.setParameter("price", price);
        return query.getResultList();
    }
}
```

---

## Deployment Steps

To deploy EJBs to a server (e.g., WildFly, GlassFish):

1. **Configure Persistence**: Ensure `persistence.xml` file is properly set up with database connection details.
2. **Package EJB Module**: Package your EJBs in a `.jar` or `.war` file.
3. **Deploy to Server**:
   - Place the `.jar`/`.war` file in the `deployments` directory.
   - Use the admin console or command-line tools (e.g., `asadmin` for GlassFish).
4. **Verify Deployment**:
   - Check logs for deployment messages.
   - Test endpoints or services to confirm theyâ€™re operational.

---

## Comparison with Spring Framework

| Feature                     | EJB 3.2                   | Spring Framework                   |
|-----------------------------|---------------------------|------------------------------------|
| **Complexity**              | Simplified with Annotations but still requires setup in a Java EE environment. | Lightweight, container-agnostic, and highly flexible. |
| **Dependency Injection**    | Limited to `@EJB` and `@Resource` | Extensive DI support with `@Autowired`, `@Qualifier`, etc. |
| **Transaction Management**  | Managed automatically within a JTA container | Flexible transaction management with `@Transactional` |
| **Persistence**             | JPA for persistence, tightly integrated | Uses Spring Data JPA for an enhanced persistence experience |
| **Scalability**             | Designed for distributed systems | Also scalable, but typically used in microservices and cloud-native applications |
| **Testing**                 | More challenging due to dependency on the container | Easier testing with support for JUnit, MockBean, and integration testing tools |

While EJB 3.2 is robust for large, distributed Java EE applications, **Spring** offers more flexibility and ease for building microservices and containerized applications.

---

## Bibliography

- [Jakarta Enterprise Beans Specification](https://jakarta.ee/specifications/enterprise-beans/)
- [Oracle EJB Documentation](https://docs.oracle.com/javaee/7/tutorial/ejb-intro.htm)
- [Spring Framework Documentation](https://spring.io/projects/spring-framework)
- [Hibernate Documentation](https://hibernate.org/orm/documentation/)

---

